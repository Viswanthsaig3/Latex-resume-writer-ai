{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\viswa\\\\Downloads\\\\Latex resume writer ai\\\\frontend\\\\src\\\\components\\\\AIAssistant.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport axios from 'axios';\nimport ModelSelector from './ModelSelector';\nimport '../styles/AIAssistant.css';\n\n// Accept activeTemplateName prop\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction AIAssistant({\n  latexCode,\n  onApplyChanges,\n  darkMode,\n  activeTemplateName\n}) {\n  _s();\n  const [isMinimized, setIsMinimized] = useState(false);\n  const [isCollapsed, setIsCollapsed] = useState(false);\n  const [prompt, setPrompt] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [selectedModel, setSelectedModel] = useState('deepseek-chat'); // Default to deepseek-chat\n  const [conversation, setConversation] = useState([{\n    role: 'ai',\n    // Update initial message to reflect template context possibility\n    content: `Hello! I can help improve your resume (currently based on '${activeTemplateName || 'Default'}'). What would you like me to help with?`\n  }]);\n  const chatBodyRef = useRef(null);\n  const inputRef = useRef(null);\n\n  // Update initial message if template name changes\n  useEffect(() => {\n    setConversation(prev => {\n      const firstMessage = prev[0];\n      if (firstMessage && firstMessage.role === 'ai') {\n        firstMessage.content = `Hello! I can help improve your resume (currently based on '${activeTemplateName || 'Default'}'). What would you like me to help with?`;\n      }\n      return [...prev];\n    });\n  }, [activeTemplateName]);\n  useEffect(() => {\n    if (chatBodyRef.current) {\n      chatBodyRef.current.scrollTop = chatBodyRef.current.scrollHeight;\n    }\n\n    // Focus input when assistant is opened\n    if (!isMinimized && !isCollapsed && inputRef.current) {\n      inputRef.current.focus();\n    }\n  }, [conversation, isMinimized, isCollapsed]);\n  const handleSendPrompt = async () => {\n    if (!prompt.trim() || isLoading) return;\n\n    // Add user message to conversation\n    const userMessage = {\n      role: 'user',\n      content: prompt\n    };\n    setConversation(prev => [...prev, userMessage]);\n\n    // Clear input field\n    setPrompt('');\n\n    // Start loading\n    setIsLoading(true);\n\n    // Save the prompt for potential retry\n    const currentPrompt = prompt;\n    try {\n      // Add temporary \"thinking\" message\n      setConversation(prev => [...prev, {\n        role: 'ai',\n        content: `Thinking... (using ${selectedModel}, template: ${activeTemplateName || 'Default'})`,\n        isTemporary: true\n      }]);\n\n      // Call the backend API with enhanced error handling\n      const response = await axios.post('http://localhost:5001/ai/improve-resume', {\n        prompt: currentPrompt,\n        latex: latexCode,\n        modelId: selectedModel,\n        templateName: activeTemplateName // Send template name\n      }, {\n        timeout: 180000 // 3 minutes timeout (increased from 2 minutes)\n      });\n\n      // Remove temporary message\n      setConversation(prev => prev.filter(msg => !msg.isTemporary));\n      if (response.data && response.data.success) {\n        const aiContent = response.data.response;\n\n        // Add AI response to conversation\n        setConversation(prev => [...prev, {\n          role: 'ai',\n          content: aiContent\n        }]);\n\n        // Auto-apply LaTeX code if found in response\n        if (aiContent.includes('```latex')) {\n          console.log('Auto-applying LaTeX code from AI response');\n          extractAndApplyLatex(aiContent);\n        }\n      } else {\n        var _response$data;\n        throw new Error(((_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.error) || 'Failed to get response from AI');\n      }\n    } catch (error) {\n      console.error('Error getting AI response:', error);\n\n      // Remove temporary message\n      setConversation(prev => prev.filter(msg => !msg.isTemporary));\n\n      // Add more helpful error message\n      let errorMsg = \"I'm having trouble connecting. Please try again or check your network connection.\";\n      if (error.response) {\n        if (error.response.status === 400) {\n          errorMsg = \"There was an issue with the AI request format. Please try a different model or simplify your request.\";\n        } else if (error.response.status === 401 || error.response.status === 403) {\n          errorMsg = \"Authentication error with the AI service. The API key may be invalid or expired.\";\n        } else if (error.response.status === 429) {\n          errorMsg = \"The AI service rate limit has been reached. Please try again in a few minutes.\";\n        } else if (error.response.status >= 500) {\n          errorMsg = \"The AI service is currently experiencing issues. Please try again later.\";\n        } else {\n          var _error$response$data;\n          errorMsg = `Server error: ${error.response.status} - ${((_error$response$data = error.response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message}`;\n        }\n      } else if (error.code === 'ECONNABORTED') {\n        errorMsg = \"The request timed out. The AI model may be busy - please try a different model or try again later.\";\n      } else if (!navigator.onLine) {\n        errorMsg = \"You appear to be offline. Please check your internet connection.\";\n      }\n\n      // Add the error message to the conversation\n      setConversation(prev => [...prev, {\n        role: 'ai',\n        content: errorMsg + \"\\n\\nHere's a generic suggestion based on your request:\\n\\n\" + \"Consider using action verbs, quantifying achievements, and ensuring consistent formatting in your resume. \" + \"For example, change 'Responsible for managing team' to 'Led 5-person team, increasing productivity by 20%.'\"\n      }]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Extract and apply LaTeX code from message content\n  const extractAndApplyLatex = content => {\n    console.log(\"Attempting to extract and apply LaTeX code...\");\n\n    // Find all code blocks with ```latex ... ```\n    const latexRegex = /```latex\\n([\\s\\S]*?)```/g;\n    const matches = [...content.matchAll(latexRegex)];\n    if (matches && matches.length > 0) {\n      // Get the last LaTeX code block (most likely the complete one)\n      const lastMatch = matches[matches.length - 1];\n      const extractedCode = lastMatch[1];\n      console.log(\"Extracted LaTeX code successfully:\", extractedCode.substring(0, 50) + \"...\");\n\n      // Apply the changes\n      if (extractedCode && extractedCode.trim().length > 0) {\n        onApplyChanges(extractedCode);\n        console.log(\"LaTeX code applied to editor\");\n        return true;\n      }\n    }\n    console.warn(\"No valid LaTeX code blocks found in:\", content.substring(0, 100) + \"...\");\n    return false;\n  };\n\n  // Handle apply changes button click\n  const handleApplyChanges = content => {\n    // Just call our extract and apply function with the content\n    return extractAndApplyLatex(content);\n  };\n\n  // Format message content - handle LaTeX code blocks\n  const formatMessage = content => {\n    if (!content) return '';\n    if (content.startsWith('Thinking...')) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"thinking-indicator\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"typing-indicator\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"thinking-text\",\n          children: content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this);\n    }\n\n    // Split by code blocks\n    const parts = [];\n    let lastIndex = 0;\n\n    // Match ```latex ... ``` blocks\n    const codeBlockRegex = /```latex\\n([\\s\\S]*?)```/g;\n    let match;\n    while ((match = codeBlockRegex.exec(content)) !== null) {\n      // Add text before code block\n      if (match.index > lastIndex) {\n        parts.push({\n          type: 'text',\n          content: content.substring(lastIndex, match.index)\n        });\n      }\n\n      // Add the code block\n      parts.push({\n        type: 'latex',\n        content: match[1]\n      });\n      lastIndex = match.index + match[0].length;\n    }\n\n    // Add any remaining text\n    if (lastIndex < content.length) {\n      parts.push({\n        type: 'text',\n        content: content.substring(lastIndex)\n      });\n    }\n\n    // Render parts\n    return parts.map((part, index) => {\n      if (part.type === 'text') {\n        // Format markdown-style syntax in text parts\n        const formattedText = part.content.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>').replace(/\\*(.*?)\\*/g, '<em>$1</em>').replace(/`(.*?)`/g, '<code>$1</code>');\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-content\",\n          dangerouslySetInnerHTML: {\n            __html: formattedText\n          }\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this);\n      } else {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"latex-block-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"pre\", {\n            className: \"latex-block\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"latex-header\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"LaTeX Code\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"code\", {\n              children: part.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"apply-btn\",\n            onClick: () => handleApplyChanges(\"```latex\\n\" + part.content + \"\\n```\") // Wrap with latex markers\n            ,\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-check-circle\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 15\n            }, this), \" Apply Changes\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, this);\n      }\n    });\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendPrompt();\n    }\n  };\n  const handleMaximize = () => {\n    setIsMinimized(false);\n    setIsCollapsed(false);\n  };\n  const handleMinimize = () => {\n    setIsMinimized(true);\n    setIsCollapsed(false);\n  };\n  const handleCollapse = () => {\n    setIsCollapsed(!isCollapsed);\n    setIsMinimized(false);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `ai-assistant ${darkMode ? 'dark-mode' : ''} ${isMinimized ? 'minimized' : ''} ${isCollapsed ? 'collapsed' : ''}`,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"assistant-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"assistant-title\",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fa fa-robot\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"AI Assistant\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"assistant-controls\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"assistant-control\",\n          onClick: handleMinimize,\n          title: \"Minimize\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fa fa-window-minimize\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"assistant-control\",\n          onClick: handleCollapse,\n          title: isCollapsed ? \"Expand\" : \"Collapse\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: `fa fa-${isCollapsed ? 'expand' : 'compress'}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"assistant-control close\",\n          onClick: () => setIsMinimized(true),\n          title: \"Close\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fa fa-times\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 7\n    }, this), !isMinimized && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [!isCollapsed && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"model-selector-container\",\n        children: /*#__PURE__*/_jsxDEV(ModelSelector, {\n          selectedModel: selectedModel,\n          onModelChange: setSelectedModel,\n          darkMode: darkMode\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"assistant-body\",\n        ref: chatBodyRef,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"messages-container\",\n          children: conversation.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `message ${msg.role}`,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-avatar\",\n              children: msg.role === 'ai' ? /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-robot\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 337,\n                columnNumber: 23\n              }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-user\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 339,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-content\",\n              children: msg.role === 'ai' ? formatMessage(msg.content) : msg.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"assistant-input\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          ref: inputRef,\n          value: prompt,\n          onChange: e => setPrompt(e.target.value),\n          onKeyPress: handleKeyPress,\n          placeholder: \"Ask how to improve your resume...\",\n          disabled: isLoading,\n          rows: 1\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `send-button ${isLoading || !prompt.trim() ? 'disabled' : ''}`,\n          onClick: handleSendPrompt,\n          disabled: isLoading || !prompt.trim(),\n          children: isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"button-spinner\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fa fa-paper-plane\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), isMinimized && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"minimized-indicator\",\n      onClick: handleMaximize,\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fa fa-robot\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"Open AI Assistant\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 282,\n    columnNumber: 5\n  }, this);\n}\n_s(AIAssistant, \"KMR9IVGgKC45TJhvHfxqJBUBhYQ=\");\n_c = AIAssistant;\nexport default AIAssistant;\nvar _c;\n$RefreshReg$(_c, \"AIAssistant\");","map":{"version":3,"names":["React","useState","useRef","useEffect","axios","ModelSelector","jsxDEV","_jsxDEV","Fragment","_Fragment","AIAssistant","latexCode","onApplyChanges","darkMode","activeTemplateName","_s","isMinimized","setIsMinimized","isCollapsed","setIsCollapsed","prompt","setPrompt","isLoading","setIsLoading","selectedModel","setSelectedModel","conversation","setConversation","role","content","chatBodyRef","inputRef","prev","firstMessage","current","scrollTop","scrollHeight","focus","handleSendPrompt","trim","userMessage","currentPrompt","isTemporary","response","post","latex","modelId","templateName","timeout","filter","msg","data","success","aiContent","includes","console","log","extractAndApplyLatex","_response$data","Error","error","errorMsg","status","_error$response$data","message","code","navigator","onLine","latexRegex","matches","matchAll","length","lastMatch","extractedCode","substring","warn","handleApplyChanges","formatMessage","startsWith","className","children","fileName","_jsxFileName","lineNumber","columnNumber","parts","lastIndex","codeBlockRegex","match","exec","index","push","type","map","part","formattedText","replace","dangerouslySetInnerHTML","__html","onClick","handleKeyPress","e","key","shiftKey","preventDefault","handleMaximize","handleMinimize","handleCollapse","title","onModelChange","ref","value","onChange","target","onKeyPress","placeholder","disabled","rows","_c","$RefreshReg$"],"sources":["C:/Users/viswa/Downloads/Latex resume writer ai/frontend/src/components/AIAssistant.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport ModelSelector from './ModelSelector';\r\nimport '../styles/AIAssistant.css';\r\n\r\n// Accept activeTemplateName prop\r\nfunction AIAssistant({ latexCode, onApplyChanges, darkMode, activeTemplateName }) {\r\n  const [isMinimized, setIsMinimized] = useState(false);\r\n  const [isCollapsed, setIsCollapsed] = useState(false);\r\n  const [prompt, setPrompt] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [selectedModel, setSelectedModel] = useState('deepseek-chat'); // Default to deepseek-chat\r\n  const [conversation, setConversation] = useState([\r\n    {\r\n      role: 'ai',\r\n      // Update initial message to reflect template context possibility\r\n      content: `Hello! I can help improve your resume (currently based on '${activeTemplateName || 'Default'}'). What would you like me to help with?`\r\n    }\r\n  ]);\r\n  \r\n  const chatBodyRef = useRef(null);\r\n  const inputRef = useRef(null);\r\n  \r\n  // Update initial message if template name changes\r\n  useEffect(() => {\r\n    setConversation(prev => {\r\n      const firstMessage = prev[0];\r\n      if (firstMessage && firstMessage.role === 'ai') {\r\n        firstMessage.content = `Hello! I can help improve your resume (currently based on '${activeTemplateName || 'Default'}'). What would you like me to help with?`;\r\n      }\r\n      return [...prev];\r\n    });\r\n  }, [activeTemplateName]);\r\n\r\n  useEffect(() => {\r\n    if (chatBodyRef.current) {\r\n      chatBodyRef.current.scrollTop = chatBodyRef.current.scrollHeight;\r\n    }\r\n    \r\n    // Focus input when assistant is opened\r\n    if (!isMinimized && !isCollapsed && inputRef.current) {\r\n      inputRef.current.focus();\r\n    }\r\n  }, [conversation, isMinimized, isCollapsed]);\r\n  \r\n  const handleSendPrompt = async () => {\r\n    if (!prompt.trim() || isLoading) return;\r\n    \r\n    // Add user message to conversation\r\n    const userMessage = { role: 'user', content: prompt };\r\n    setConversation(prev => [...prev, userMessage]);\r\n    \r\n    // Clear input field\r\n    setPrompt('');\r\n    \r\n    // Start loading\r\n    setIsLoading(true);\r\n    \r\n    // Save the prompt for potential retry\r\n    const currentPrompt = prompt;\r\n    \r\n    try {\r\n      // Add temporary \"thinking\" message\r\n      setConversation(prev => [\r\n        ...prev, \r\n        { role: 'ai', content: `Thinking... (using ${selectedModel}, template: ${activeTemplateName || 'Default'})`, isTemporary: true }\r\n      ]);\r\n      \r\n      // Call the backend API with enhanced error handling\r\n      const response = await axios.post('http://localhost:5001/ai/improve-resume', {\r\n        prompt: currentPrompt,\r\n        latex: latexCode,\r\n        modelId: selectedModel,\r\n        templateName: activeTemplateName // Send template name\r\n      }, { \r\n        timeout: 180000 // 3 minutes timeout (increased from 2 minutes)\r\n      });\r\n      \r\n      // Remove temporary message\r\n      setConversation(prev => prev.filter(msg => !msg.isTemporary));\r\n      \r\n      if (response.data && response.data.success) {\r\n        const aiContent = response.data.response;\r\n        \r\n        // Add AI response to conversation\r\n        setConversation(prev => [...prev, { role: 'ai', content: aiContent }]);\r\n        \r\n        // Auto-apply LaTeX code if found in response\r\n        if (aiContent.includes('```latex')) {\r\n          console.log('Auto-applying LaTeX code from AI response');\r\n          extractAndApplyLatex(aiContent);\r\n        }\r\n      } else {\r\n        throw new Error(response.data?.error || 'Failed to get response from AI');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error getting AI response:', error);\r\n      \r\n      // Remove temporary message\r\n      setConversation(prev => prev.filter(msg => !msg.isTemporary));\r\n      \r\n      // Add more helpful error message\r\n      let errorMsg = \"I'm having trouble connecting. Please try again or check your network connection.\";\r\n      \r\n      if (error.response) {\r\n        if (error.response.status === 400) {\r\n          errorMsg = \"There was an issue with the AI request format. Please try a different model or simplify your request.\";\r\n        } else if (error.response.status === 401 || error.response.status === 403) {\r\n          errorMsg = \"Authentication error with the AI service. The API key may be invalid or expired.\";\r\n        } else if (error.response.status === 429) {\r\n          errorMsg = \"The AI service rate limit has been reached. Please try again in a few minutes.\";\r\n        } else if (error.response.status >= 500) {\r\n          errorMsg = \"The AI service is currently experiencing issues. Please try again later.\";\r\n        } else {\r\n          errorMsg = `Server error: ${error.response.status} - ${error.response.data?.message || error.message}`;\r\n        }\r\n      } else if (error.code === 'ECONNABORTED') {\r\n        errorMsg = \"The request timed out. The AI model may be busy - please try a different model or try again later.\";\r\n      } else if (!navigator.onLine) {\r\n        errorMsg = \"You appear to be offline. Please check your internet connection.\";\r\n      }\r\n      \r\n      // Add the error message to the conversation\r\n      setConversation(prev => [\r\n        ...prev, \r\n        { \r\n          role: 'ai', \r\n          content: errorMsg + \"\\n\\nHere's a generic suggestion based on your request:\\n\\n\" +\r\n            \"Consider using action verbs, quantifying achievements, and ensuring consistent formatting in your resume. \" +\r\n            \"For example, change 'Responsible for managing team' to 'Led 5-person team, increasing productivity by 20%.'\"\r\n        }\r\n      ]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n  \r\n  // Extract and apply LaTeX code from message content\r\n  const extractAndApplyLatex = (content) => {\r\n    console.log(\"Attempting to extract and apply LaTeX code...\");\r\n    \r\n    // Find all code blocks with ```latex ... ```\r\n    const latexRegex = /```latex\\n([\\s\\S]*?)```/g;\r\n    const matches = [...content.matchAll(latexRegex)];\r\n    \r\n    if (matches && matches.length > 0) {\r\n      // Get the last LaTeX code block (most likely the complete one)\r\n      const lastMatch = matches[matches.length - 1];\r\n      const extractedCode = lastMatch[1];\r\n      \r\n      console.log(\"Extracted LaTeX code successfully:\", extractedCode.substring(0, 50) + \"...\");\r\n      \r\n      // Apply the changes\r\n      if (extractedCode && extractedCode.trim().length > 0) {\r\n        onApplyChanges(extractedCode);\r\n        console.log(\"LaTeX code applied to editor\");\r\n        return true;\r\n      }\r\n    }\r\n    \r\n    console.warn(\"No valid LaTeX code blocks found in:\", content.substring(0, 100) + \"...\");\r\n    return false;\r\n  };\r\n  \r\n  // Handle apply changes button click\r\n  const handleApplyChanges = (content) => {\r\n    // Just call our extract and apply function with the content\r\n    return extractAndApplyLatex(content);\r\n  };\r\n\r\n  // Format message content - handle LaTeX code blocks\r\n  const formatMessage = (content) => {\r\n    if (!content) return '';\r\n    \r\n    if (content.startsWith('Thinking...')) {\r\n      return (\r\n        <div className=\"thinking-indicator\">\r\n          <div className=\"typing-indicator\">\r\n            <span></span>\r\n            <span></span>\r\n            <span></span>\r\n          </div>\r\n          <span className=\"thinking-text\">{content}</span>\r\n        </div>\r\n      );\r\n    }\r\n    \r\n    // Split by code blocks\r\n    const parts = [];\r\n    let lastIndex = 0;\r\n    \r\n    // Match ```latex ... ``` blocks\r\n    const codeBlockRegex = /```latex\\n([\\s\\S]*?)```/g;\r\n    let match;\r\n    \r\n    while ((match = codeBlockRegex.exec(content)) !== null) {\r\n      // Add text before code block\r\n      if (match.index > lastIndex) {\r\n        parts.push({\r\n          type: 'text',\r\n          content: content.substring(lastIndex, match.index)\r\n        });\r\n      }\r\n      \r\n      // Add the code block\r\n      parts.push({\r\n        type: 'latex',\r\n        content: match[1]\r\n      });\r\n      \r\n      lastIndex = match.index + match[0].length;\r\n    }\r\n    \r\n    // Add any remaining text\r\n    if (lastIndex < content.length) {\r\n      parts.push({\r\n        type: 'text',\r\n        content: content.substring(lastIndex)\r\n      });\r\n    }\r\n    \r\n    // Render parts\r\n    return parts.map((part, index) => {\r\n      if (part.type === 'text') {\r\n        // Format markdown-style syntax in text parts\r\n        const formattedText = part.content\r\n          .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\r\n          .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\r\n          .replace(/`(.*?)`/g, '<code>$1</code>');\r\n          \r\n        return (\r\n          <div \r\n            key={index} \r\n            className=\"text-content\"\r\n            dangerouslySetInnerHTML={{ __html: formattedText }}\r\n          />\r\n        );\r\n      } else {\r\n        return (\r\n          <div key={index} className=\"latex-block-container\">\r\n            <pre className=\"latex-block\">\r\n              <div className=\"latex-header\">\r\n                <span>LaTeX Code</span>\r\n              </div>\r\n              <code>{part.content}</code>\r\n            </pre>\r\n            <button \r\n              className=\"apply-btn\"\r\n              onClick={() => handleApplyChanges(\"```latex\\n\" + part.content + \"\\n```\")} // Wrap with latex markers\r\n            >\r\n              <i className=\"fa fa-check-circle\"></i> Apply Changes\r\n            </button>\r\n          </div>\r\n        );\r\n      }\r\n    });\r\n  };\r\n  \r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSendPrompt();\r\n    }\r\n  };\r\n  \r\n  const handleMaximize = () => {\r\n    setIsMinimized(false);\r\n    setIsCollapsed(false);\r\n  };\r\n  \r\n  const handleMinimize = () => {\r\n    setIsMinimized(true);\r\n    setIsCollapsed(false);\r\n  };\r\n  \r\n  const handleCollapse = () => {\r\n    setIsCollapsed(!isCollapsed);\r\n    setIsMinimized(false);\r\n  };\r\n\r\n  return (\r\n    <div className={`ai-assistant ${darkMode ? 'dark-mode' : ''} ${isMinimized ? 'minimized' : ''} ${isCollapsed ? 'collapsed' : ''}`}>\r\n      <div className=\"assistant-header\">\r\n        <div className=\"assistant-title\">\r\n          <i className=\"fa fa-robot\"></i>\r\n          <span>AI Assistant</span>\r\n        </div>\r\n        \r\n        <div className=\"assistant-controls\">\r\n          <button \r\n            className=\"assistant-control\"\r\n            onClick={handleMinimize}\r\n            title=\"Minimize\"\r\n          >\r\n            <i className=\"fa fa-window-minimize\"></i>\r\n          </button>\r\n          \r\n          <button \r\n            className=\"assistant-control\"\r\n            onClick={handleCollapse}\r\n            title={isCollapsed ? \"Expand\" : \"Collapse\"}\r\n          >\r\n            <i className={`fa fa-${isCollapsed ? 'expand' : 'compress'}`}></i>\r\n          </button>\r\n          \r\n          <button \r\n            className=\"assistant-control close\"\r\n            onClick={() => setIsMinimized(true)}\r\n            title=\"Close\"\r\n          >\r\n            <i className=\"fa fa-times\"></i>\r\n          </button>\r\n        </div>\r\n      </div>\r\n      \r\n      {!isMinimized && (\r\n        <>\r\n          {!isCollapsed && (\r\n            <div className=\"model-selector-container\">\r\n              <ModelSelector \r\n                selectedModel={selectedModel}\r\n                onModelChange={setSelectedModel}\r\n                darkMode={darkMode}\r\n              />\r\n            </div>\r\n          )}\r\n          \r\n          <div className=\"assistant-body\" ref={chatBodyRef}>\r\n            <div className=\"messages-container\">\r\n              {conversation.map((msg, index) => (\r\n                <div\r\n                  key={index}\r\n                  className={`message ${msg.role}`}\r\n                >\r\n                  <div className=\"message-avatar\">\r\n                    {msg.role === 'ai' ? (\r\n                      <i className=\"fa fa-robot\"></i>\r\n                    ) : (\r\n                      <i className=\"fa fa-user\"></i>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"message-content\">\r\n                    {msg.role === 'ai' ? formatMessage(msg.content) : msg.content}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"assistant-input\">\r\n            <textarea\r\n              ref={inputRef}\r\n              value={prompt}\r\n              onChange={(e) => setPrompt(e.target.value)}\r\n              onKeyPress={handleKeyPress}\r\n              placeholder=\"Ask how to improve your resume...\"\r\n              disabled={isLoading}\r\n              rows={1}\r\n            />\r\n            <button\r\n              className={`send-button ${isLoading || !prompt.trim() ? 'disabled' : ''}`}\r\n              onClick={handleSendPrompt}\r\n              disabled={isLoading || !prompt.trim()}\r\n            >\r\n              {isLoading ? (\r\n                <div className=\"button-spinner\"></div>\r\n              ) : (\r\n                <i className=\"fa fa-paper-plane\"></i>\r\n              )}\r\n            </button>\r\n          </div>\r\n        </>\r\n      )}\r\n      \r\n      {isMinimized && (\r\n        <div className=\"minimized-indicator\" onClick={handleMaximize}>\r\n          <i className=\"fa fa-robot\"></i>\r\n          <span>Open AI Assistant</span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AIAssistant;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}